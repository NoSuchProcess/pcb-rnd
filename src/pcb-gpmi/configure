#!/bin/sh

gpmi_fstools=`gpmi-config --id 2>/dev/null`
if test -z "$gpmi_fstools"
then
	echo "Can't find GPMI installed."
	echo "You can donwload GPMI from svn://repo.hu/gpmi/trunk"
	exit
else
	echo "Found GPMI."
fi

pwd=`cd ../.. && pwd`
pcb_src_dirs="$pwd"

for n in $pcb_src_dirs
do
	if test -f $n/src/hid.h
	then
		echo "Found pcb source dir: $n"
		pcb_src=$n
		break
	fi
done

if test -z "$pcb_src"
then
	echo "Can't find pcb source. Run \"./configure pcb_src_path\"."
	exit
fi


echo '# Makefile.config for pcb-gpmi. This file was generated by ./configure 
# at '`date`'

PCB_SRC='$pcb_src'
###TODO1###
PCB_CFLAGS=-I/usr/lib/i386-linux-gnu/glib-2.0/include -I/usr/include/glib-2.0
'> Makefile.config

cd gpmi_plugin && ./configure
