<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<title> pcb-rnd user manual </title>
	<meta http-equiv="Content-Type" content="text/html;charset=us-ascii">
	<link rel="stylesheet" type="text/css" href="../../default.css">
</head>
<body>
<h2 id="" autotoc="yes"> draw_pnp plugin </h2>
<p>
The optional draw_pnp plugin can auto-generate a pair of helper doc
layers for pick-and-place. The layers contain autogenerated graphics for:
<ul>
	<li> an optional frame around each subcircuit (to indicate position)
	<li> an optional filled circle mark in the center of terminal 1 (to indicate orientation)
	<li> the refdes text printed approximately at the subcircuit's origin (not in the p&p origin)
</ul>
<p>
The two layers are for top and bottom; autogenerated graphics for
the subcircuits placed on the top side of the board go on the top layer while
bottom side subcircuits go on the bottom layer. Both layers are optional, it
is possible to have zero, only one of them or both of them.
<p>
The easiest way to create the layers is executing the <i>DrawPnpLayers(create)</i>
action or invoke the action from the menu system: right click over a layer
group name (vertically printed text in the layer selector's left side), "Create
new group" menu in the context popup, "Create pnp helper..." menu. The action
creates both top and bottom layer group and layer. If only one of them is needed,
the other group should be removed by invoking the same context menu over
the name of the layer group (not the layer), selecting the "Remove group" submenu.
<p>
The default config for the cam plugin contains rules for exporting pnp helper
documentation. These rules are called doc_pnp_*. This feature is accessible
using the File menu, "Export with CAM..." submenu.

<h3> Tips &amp; tricks, extras </h3>
<p>
The pnp doc layers are also editable and can host user drawn objects. It's
recommended to draw pick-and-place related instructions onto these layers.
<p>
Layer compositing works normally: the layer can be turned into a 'sub' layer
making it inverted. It's possible to create multiple layers within the
layer group, both positive and negative layers; adding a negative layer at
the end of the group allows the user to erase some of the autogenerated
documentation.
<p>
Rendering details such as text scale, text/line/dot thickness can be fine tuned
in the config tree (see: preferences dialog, rightmost tab). The subtree
of interest is plugins/draw_pnp.

<h3> Technical details on layer groups and layers </h3>
<p>
The layer group needs to be created so that:
<ul>
	<li> its type is doc
	<li> its location is either top or bottom
	<li> its purpose is: <i>pnp</i>
	<li> usually the group has the attribute <i>init-inivis=1</i> so that it's made invisible after loading the board
</ul>
<p>
The layer (within this group) where automatically generated graphics should go
must have the attribute <i>pcb-rnd::plugin_draw=draw_pnp</i>
<p>
There can be multiple layers having the <i>pcb-rnd::plugin_draw=draw_pnp</i>
attribute and all of them will run the renderer. The layer does not have to
be in a doc layer group - it can be on silk or even copper, but beware:
the plugin is a rendering trick; even when it renders onto a copper layer, it
will not actually create objects so the auto-generated graphics will be
invisible to connectivity checks and poly clipping. It's strongly recommended
to have these layers only in doc layer groups.
<p>
The default cam export job will look for top or bottom doc layer groups with
the purpose set to pnp. Any deviation from that will not export with the stock
cam config (but it's easy to write custom cam jobs that pick up the layer
group differently.)

<h3> Technical details on rendering and compatibility </h3>
<p>
The plugin uses the so called plugin_draw mechanism where the core layer
renderer calls a plugin provided function instead of doing the normal rendering.
The plugin hooks the plugin_draw function on layers that have the
<i>pcb-rnd::plugin_draw=draw_pnp</i>, regardless of layer group properties.
<p>
Since this mechanism depends only on a layer attribute, a file created with
a pcb-rnd having the draw_pnp plugin will still be loadable using a pcb-rnd
not having the plugin. Custom user drawn objects will appear properly,
but the pcb-rnd that lacks draw_pnp obviously won't render the auto-generated
graphics. However, using this feature it is not possible to break backward or
forward compatibility of board files to a level that the board gets unloadable.

</body>
</html>
